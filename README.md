# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## Типы данных, используемые в приложении

Данные о товаре, которые приходят с сервера

 - category: string  - категория товара;
 - id: string - Id товара;
 - description: string - описание товара;
 - image: string - изображение товара;
 - title: string - название товара;
 - price: number | null - цена товара;


Тип оплаты
 - TPaymentMethod = "online" | "offline"  - вариант оплаты товара;


## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP:

 - слой данных, отвечает за хранение и изменение данных
 - слой представления, отвечает за отображение данных на странице,
 - презентер, отвечает за связь представления и данных.

Презентор не будет выделен в отдельный класс, а будет реализовываться в основном скрипте index.ts

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов. Методы:

get - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
post - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется POST запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.
Основные методы, реализуемые классом описаны интерфейсом IEvents:

 - on - подписка на событие 
 - emit - инициализация события
 - trigger - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

### Слой коммуникации

#### Класс LarekApi

Наследуется от базового класс Api. Предоставляет методы для взаимодействия с бэкендом для получения данных товаров, а так же отправки заказа пользователя. 

Конструктор принимает:

 - baseUrl -  базовый URL-адрес приложения.
 - cdn - URL CDN, используемый для загрузки изображений товаров.
 - options - объект, содержащий дополнительные параметры конфигурации.

 Методы:
  - getProducts - отправляет GET запрос для получения данных о товаре.
  - addOrder  - отправляет POST запрос для отправки данных о заказе пользоваетля.
  
### Слой работы с данными

#### Класс ProductsData

Класс, предоставляющий методы для взаимодействия с коллекцией продуктов и отправки событий при изменении коллекции.

Свойства:

- _items - массив IProduct объектов.
- events - объект для управления событиями при изменении даннных.

Конструктор инициализирует объект events.

Методы:

 - getItem(id: string) - возвращает данные об еденице товара по его id.
 - set/get items - сеттер/геттер для хранения и работы с массивом товаров.


 ### Слой отображения 



 #### Класс ModalView

Класс предназанчен для работы с модальными окнами.\ Наследуется от базового класса Component.\ 

Свойства:

- closeButton - кнопка для закрытия модального окна.
- _content - область содержимого модального окна.
- events - объект для управления событиями при изменении даннных.

Контсруктор инициализирует поля класса.

Методы:

- set content(value: HTMLElement) - устанавливает содержимое модального окна.
- open() - открывает модальное окно, генерирует событие "modal:open" и добавляет на страницу обработчик закрытия модального окна при нажатии клавиши "Escape".
- close() - открывает модальное окно, генерирует событие "modal:closed", снимает с документа обработчик закрытия модального окна при нажатии клавиши "Escape".
- handleEscUp (evt: KeyboardEvent) - закрытие модального окна кливашей Escape.
- render(data: IModalData) - рендерит модальное окно с установленным контентом и открывает его.



